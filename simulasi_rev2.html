<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Simulasi Keuangan</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #eef2f5;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      transition: background-color 0.5s ease, color 0.5s ease;
    }
    .container {
      max-width: 700px;
      margin: auto;
      background: #fff;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
      overflow: hidden;
      transition: background-color 0.5s ease, box-shadow 0.5s ease;
    }
    h2 {
      text-align: center;
      color: #0056b3;
      margin-bottom: 25px;
      font-weight: 600;
      transition: color 0.5s ease;
    }
    .form-group {
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: bold;
      color: #555;
      transition: color 0.5s ease;
    }
    input, select {
      width: 100%;
      padding: 12px;
      font-size: 1.05rem;
      border: 1px solid #cce0f0;
      border-radius: 8px;
      box-sizing: border-box;
      transition: border-color 0.3s ease, box-shadow 0.3s ease, background-color 0.5s ease, color 0.5s ease;
    }
    input:focus, select:focus {
      border-color: #007bff;
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
      outline: none;
    }
    button {
      width: 100%;
      padding: 14px;
      background: #007bff;
      color: white;
      font-size: 1.1rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease, color 0.5s ease;
      margin-top: 10px;
    }
    button:hover {
      background-color: #0056b3;
      transform: translateY(-2px);
    }
    button:active {
      transform: translateY(0);
    }
    .result-container {
      margin-top: 35px;
      padding: 25px;
      background: #f8fbfd;
      border-radius: 10px;
      border: 1px solid #e0e7ee;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInSlideUp 0.6s ease-out forwards;
      transition: background-color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease;
    }
    @keyframes fadeInSlideUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .result-container h3 {
      color: #0056b3;
      margin-bottom: 20px;
      text-align: center;
      transition: color 0.5s ease;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    th, td {
      border: 1px solid #e7eff5;
      padding: 10px 12px;
      text-align: left;
      font-size: 0.95rem;
      transition: background-color 0.5s ease, color 0.5s ease, border-color 0.5s ease;
      white-space: nowrap;
    }
    th {
      background: #f2f7fc;
      font-weight: bold;
      color: #444;
    }
    tr:nth-child(even) {
      background-color: #f9fcff;
    }
    #cetakButton {
      text-align: center;
      margin-top: 25px;
    }
    #cetakButton button {
      background: #28a745;
    }
    #cetakButton button:hover {
      background-color: #218838;
      transform: translateY(-2px);
    }

    
    .table-responsive {
      overflow-x: auto; 
      -webkit-overflow-scrolling: touch;
    }
   

    
    body.dark-mode {
      background-color: #2c2c2c;
      color: #e0e0e0;
    }
    .dark-mode .container {
      background: #3a3a3a;
      box-shadow: 0 6px 15px rgba(0,0,0,0.4);
    }
    .dark-mode h2 {
      color: #90caf9;
    }
    .dark-mode label {
      color: #bbbbbb;
    }
    .dark-mode input, .dark-mode select {
      background-color: #4a4a4a;
      border-color: #5a5a5a;
      color: #e0e0e0;
    }
    .dark-mode input:focus, .dark-mode select:focus {
      border-color: #64b5f6;
      box-shadow: 0 0 0 3px rgba(100, 181, 246, 0.25);
    }
    .dark-mode button {
      background: #1976d2;
    }
    .dark-mode button:hover {
      background-color: #1565c0;
    }
    .dark-mode .result-container {
      background: #4a4a4a;
      border-color: #5a5a5a;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
    }
    .dark-mode .result-container h3 {
      color: #90caf9;
    }
    .dark-mode th, .dark-mode td {
      border-color: #5a5a5a;
    }
    .dark-mode th {
      background: #555;
      color: #f0f0f0;
    }
    .dark-mode tr:nth-child(even) {
      background-color: #4e4e4e;
    }
    .dark-mode #cetakButton button {
      background: #388e3c;
    }
    .dark-mode #cetakButton button:hover {
      background-color: #2e7d32;
    }

    #darkModeToggle {
      position: absolute;
      top: 20px;
      right: 0px;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.8rem;
      color: #555;
      transition: color 0.3s ease, transform 0.2s ease;
    }
    #darkModeToggle:hover {
      color: #007bff;
      transform: scale(1.1);
    }

    body.dark-mode #darkModeToggle {
      color: #f0e68c;
    }
    .footer {
      text-align: center;
      margin-top: 40px;
      font-size: 0.85rem;
      color: #777;
      transition: color 0.5s ease;
    }
    .dark-mode .footer {
      color: #bbb;
    }
  </style>
</head>
<body>
  <button id="darkModeToggle" aria-label="Toggle dark mode">
    <i class="fas fa-moon"></i> </button>

  <div class="container">
    <h2>Simulasi Keuangan</h2>
    <div class="form-group">
      <label for="jenisSimulasi">Pilih Jenis Perhitungan</label>
      <select id="jenisSimulasi" onchange="ubahForm()">
        <option value="kredit">KREDIT</option>
        <option value="deposito">DEPOSITO</option>
        <option value="tabungan">TABUNGAN</option>
      </select>
    </div>

    <form id="formInput"></form>

    <button onclick="hitungSimulasi()">HITUNG</button>

    <div class="result-container" id="resultContainer">
      <h3>Rincian Detail:</h3>
      <div id="hasilSimulasi"></div>
      <div id="cetakButton" style="display:none;">
        <button onclick="cetakHasil()">üñ®Ô∏è CETAK</button>
      </div>
    </div>
  </div>

  <div class="footer">
    &copy; <span id="currentYear"></span> 4hli Prosesor
  </div>

 <script>
function cetakHasil() {
  const hasil = document.getElementById("hasilSimulasi").innerHTML;
  const newWindow = window.open("", "Cetak Hasil Simulasi", "width=800,height=600");
  newWindow.document.write("<html><head><title>Cetak Hasil Simulasi</title>");
  newWindow.document.write("<style>body { font-family: Arial; margin: 20px; } table { width: 100%; border-collapse: collapse; } table th, table td { border: 1px solid #ccc; padding: 8px; text-align: left; } table th { background: #eee; } table th, table td { white-space: nowrap; }</style>");
  newWindow.document.write("</head><body><h2>Rincian Simulasi</h2>");
  newWindow.document.write(infoCetak); 
  const tableStart = hasil.indexOf("<table");
  const tableHTML = tableStart !== -1 ? hasil.slice(tableStart) : "";
  const cleanedTableHTML = tableHTML.replace("<div class=\"table-responsive\">", "").replace("</div>", "");
  newWindow.document.write(cleanedTableHTML);
  newWindow.document.write("</body></html>");
  newWindow.document.close();
  newWindow.print();
}


function updateBungaDeposito() {
    const tenorSelect = document.getElementById("tenorDeposito");
    const bungaInput = document.getElementById("bungaDeposito");
    const selectedTenor = parseInt(tenorSelect.value);

    if (isNaN(selectedTenor)) {
        bungaInput.value = ""; 
        return;
    }

    if (selectedTenor === 1) {
        bungaInput.value = "4"; 
    } else if (selectedTenor === 3 || selectedTenor === 6 || selectedTenor === 12) {
        bungaInput.value = "4.25"; 
    } else {
        bungaInput.value = ""; 
    }
}

function ubahForm() {
  document.getElementById("hasilSimulasi").innerHTML = "";
  document.getElementById("cetakButton").style.display = "none";
  const resultContainer = document.getElementById("resultContainer");
  resultContainer.style.opacity = "0";
  resultContainer.style.transform = "translateY(20px)";
  resultContainer.style.animation = "none";
  void resultContainer.offsetWidth; 
  resultContainer.style.animation = null; 

  const jenis = document.getElementById("jenisSimulasi").value;
  const formInput = document.getElementById("formInput");
  
  
  if (jenis === "kredit") {
    formInput.innerHTML = `
      <div class="form-group">
        <label for="pinjaman">Jumlah Pinjaman (Rp)</label>
        <input type="text" id="pinjaman" oninput="formatRpInput(this)" onfocus="clearFormat(this)" onblur="formatRpInput(this)">
      </div>
      <div class="form-group">
        <label for="tenor">Tenor (bulan)</label>
        <input type="text" id="tenor">
      </div>
      <div class="form-group">
        <label for="bunga">Bunga Tahunan (%)</label>
        <input type="text" id="bunga">
      </div>
      <div class="form-group">
        <label for="jenisKredit">Jenis Kredit</label>
        <select id="jenisKredit">
          <option value="flat">Flat</option>
          <option value="sliding">Sliding</option>
          <option value="efektif">Efektif</option>
        </select>
      </div>
    `;
  } else if (jenis === "deposito") {
    formInput.innerHTML = `
      <div class="form-group">
        <label for="jumlahDeposito">Jumlah Deposito (Rp)</label>
        <input type="text" id="jumlahDeposito" oninput="formatRpInput(this)" onfocus="clearFormat(this)" onblur="formatRpInput(this)">
      </div>
      <div class="form-group">
        <label for="tenorDeposito">Tenor (bulan)</label>
        <select id="tenorDeposito" onchange="updateBungaDeposito()">
          <option value="">Pilih Tenor</option>
          <option value="1">1 bulan</option>
          <option value="3">3 bulan</option>
          <option value="6">6 bulan</option>
          <option value="12">12 bulan</option>
        </select>
      </div>
      <div class="form-group">
        <label for="bungaDeposito">Suku Bunga Tahunan (%)</label>
        <input type="text" id="bungaDeposito" readonly>
      </div>
    `;
   
    document.getElementById("bungaDeposito").value = "";
  } else if (jenis === "tabungan") {
    formInput.innerHTML = `
      <div class="form-group">
        <label for="saldoAwalTabungan">Saldo Awal (Rp)</label>
        <input type="text" id="saldoAwalTabungan" oninput="formatRpInput(this)" onfocus="clearFormat(this)" onblur="formatRpInput(this)">
      </div>
      <div class="form-group">
        <label for="setoranBulananTabungan">Setoran Bulanan (Rp)</label>
        <input type="text" id="setoranBulananTabungan" oninput="formatRpInput(this)" onfocus="clearFormat(this)" onblur="formatRpInput(this)">
      </div>
      <div class="form-group">
        <label for="tenorTabungan">Jangka Waktu (bulan)</label>
        <input type="text" id="tenorTabungan">
      </div>
      <div class="form-group">
        <label for="bungaTahunanTabungan">Suku Bunga Tahunan (%)</label>
        <input type="text" id="bungaTahunanTabungan">
      </div>
    `;
  }
}


function formatRpInput(input) {
  let value = input.value.replace(/[^\d]/g, "");
  input.value = value ? "Rp " + parseInt(value, 10).toLocaleString("id-ID") : "";
}


function clearFormat(input) {
  input.value = input.value.replace(/[^\d]/g, "");
}


function parseRupiah(str) {
  return parseInt(str.replace(/[^\d]/g, ""), 10) || 0;
}

let infoCetak = ""; 


function hitungSimulasi() {
  const jenis = document.getElementById("jenisSimulasi").value;
  const hasilEl = document.getElementById("hasilSimulasi");
  const resultContainer = document.getElementById("resultContainer");
  let html = "";
  infoCetak = ""; 

  
  resultContainer.style.opacity = "0";
  resultContainer.style.transform = "translateY(20px)";
  resultContainer.style.animation = "none";
  void resultContainer.offsetWidth; 
  resultContainer.style.animation = null;

  if (jenis === "kredit") {
    const pinjaman = parseRupiah(document.getElementById("pinjaman").value);
    const tenor = parseInt(document.getElementById("tenor").value);
    const bungaTahunan = parseFloat(document.getElementById("bunga").value);
    const jenisKredit = document.getElementById("jenisKredit").value;

    if (!pinjaman || isNaN(tenor) || isNaN(bungaTahunan) || tenor <= 0 || bungaTahunan < 0) {
      alert("Mohon isi semua kolom kredit dengan angka yang valid.");
      hasilEl.innerHTML = "";
      document.getElementById("cetakButton").style.display = "none";
      return;
    }

    const bungaBulananRate = bungaTahunan / 12 / 100;
    let sisa = pinjaman;

    
    infoCetak += `<p><strong>Jumlah Pinjaman:</strong> Rp ${pinjaman.toLocaleString("id-ID")}<br>
    <strong>Tenor:</strong> ${tenor} bulan<br>
    <strong>Jenis Kredit:</strong> ${jenisKredit.charAt(0).toUpperCase() + jenisKredit.slice(1)}</p>`;

    html += "<div class='table-responsive'>";
    html += "<table><tr><th>Bulan</th><th>Pokok</th><th>Bunga</th><th>Total</th><th>Sisa</th></tr>";

    for (let i = 1; i <= tenor; i++) {
      let pokok = 0, bunga = 0, total = 0;
      if (jenisKredit === "flat") {
        pokok = pinjaman / tenor;
        bunga = pinjaman * bungaBulananRate;
        total = pokok + bunga;
      } else if (jenisKredit === "efektif") {
        bunga = sisa * bungaBulananRate;
        pokok = pinjaman / tenor; 
        total = pokok + bunga;

        if (i === tenor) {
            pokok = sisa;
            total = pokok + bunga;
        }
      } else if (jenisKredit === "sliding") { 
        bunga = sisa * bungaBulananRate;
        
        if (i === tenor) { 
            pokok = sisa;
            total = pokok + bunga;
        } else { 
            pokok = 0;
            total = bunga;
        }
      }

      sisa -= pokok;

      html += `<tr><td>${i}</td><td>Rp ${Math.round(pokok).toLocaleString("id-ID")}</td><td>Rp ${Math.round(bunga).toLocaleString("id-ID")}</td><td>Rp ${Math.round(total).toLocaleString("id-ID")}</td><td>Rp ${Math.max(0, Math.round(sisa)).toLocaleString("id-ID")}</td></tr>`;
    }
    html += "</table>";
    html += "</div>"; 
    document.getElementById("cetakButton").style.display = "block";
  } else if (jenis === "deposito") {
    const nominal = parseRupiah(document.getElementById("jumlahDeposito").value);
    const tenor = parseInt(document.getElementById("tenorDeposito").value);
    const bunga = parseFloat(document.getElementById("bungaDeposito").value);
    const pajak = 20; 

    if (!nominal || isNaN(tenor) || isNaN(bunga) || nominal <= 0 || tenor <= 0 || bunga < 0) {
      alert("Mohon isi semua kolom deposito dengan angka yang valid. Pastikan tenor sudah dipilih.");
      hasilEl.innerHTML = "";
      document.getElementById("cetakButton").style.display = "none";
      return;
    }
    
    const hari = tenor * 30;
    const bungaKotor = (nominal * bunga / 100) / 365 * hari;
    
    const nilaiPajak = bungaKotor * pajak / 100;
    const bungaBersih = bungaKotor - nilaiPajak;

    infoCetak += `<p><strong>Jumlah Deposito:</strong> Rp ${nominal.toLocaleString("id-ID")}<br>
    <strong>Tenor:</strong> ${tenor} bulan<br>
    <strong>Bunga Per Tahun:</strong> ${bunga}%</p>`;

    
    html += "<div class='table-responsive'>";
    html += "<table>";
    html += "<tr><th>Keterangan</th><th>Nominal</th></tr>";
    html += `<tr><td>Bunga Kotor</td><td>Rp ${Math.round(bungaKotor).toLocaleString("id-ID")}</td></tr>`;
    html += `<tr><td>Pajak Bunga</td><td>Rp ${Math.round(nilaiPajak).toLocaleString("id-ID")}</td></tr>`;
    html += `<tr><td>Bunga Bersih Diterima</td><td><strong>Rp ${Math.round(bungaBersih).toLocaleString("id-ID")}</strong></td></tr>`;
    html += `<tr><td>Saldo Akhir</td><td><strong>Rp ${Math.round(nominal + bungaBersih).toLocaleString("id-ID")}</strong></td></tr>`;
    html += "</table>";
    html += "</div>";
    

    document.getElementById("cetakButton").style.display = "none";
  } else if (jenis === "tabungan") { 
    let currentSaldo = parseRupiah(document.getElementById("saldoAwalTabungan").value);
    const setoranBulananInput = parseRupiah(document.getElementById("setoranBulananTabungan").value);
    const tenorTabungan = parseInt(document.getElementById("tenorTabungan").value);
    const bungaTahunanTabungan = parseFloat(document.getElementById("bungaTahunanTabungan").value);

    const BATAS_SALDO_PAJAK = 7500000; 
    const PAJAK_BUNGA_RATE = 0.20; 

    if (isNaN(currentSaldo) || isNaN(setoranBulananInput) || isNaN(tenorTabungan) || isNaN(bungaTahunanTabungan) || currentSaldo < 0 || setoranBulananInput < 0 || tenorTabungan <= 0 || bungaTahunanTabungan < 0) {
      alert("Mohon isi semua kolom tabungan dengan angka yang valid.");
      hasilEl.innerHTML = "";
      document.getElementById("cetakButton").style.display = "none";
      return;
    }

    const bungaBulananRate = (bungaTahunanTabungan / 100) / 12;

    infoCetak += `<p><strong>Tabungan:</strong> Rp ${currentSaldo.toLocaleString("id-ID")}<br>
    <strong>Setoran Bulanan:</strong> Rp ${setoranBulananInput.toLocaleString("id-ID")}<br>
    <strong>Jangka Waktu:</strong> ${tenorTabungan} bulan<br>
    <strong>Bunga Per Tahun:</strong> ${bungaTahunanTabungan}%<br>
    </p>`;

    html += "<div class='table-responsive'>";
    html += "<table><tr><th>Bulan</th><th>Saldo</th><th>Setoran Per Bulan</th><th>Bunga Kotor</th><th>Pajak</th><th>Bunga Bersih</th><th>Saldo Akhir</th></tr>";

    let totalBungaBersih = 0;
    for (let i = 1; i <= tenorTabungan; i++) {
      let saldoAwalBulanIniTampil = currentSaldo; 
      
      let setoranBulanIni = (i === 1) ? 0 : setoranBulananInput; 

      let saldoUntukBungaCalculation = currentSaldo + setoranBulanIni; 
      
      let bungaKotorBulanan = saldoUntukBungaCalculation * bungaBulananRate;
      
      let pajakBungaBulanan = 0;
      if (saldoUntukBungaCalculation + bungaKotorBulanan >= BATAS_SALDO_PAJAK) { 
          pajakBungaBulanan = bungaKotorBulanan * PAJAK_BUNGA_RATE;
      }
      
      let bungaBersihBulanan = bungaKotorBulanan - pajakBungaBulanan;

      currentSaldo = saldoUntukBungaCalculation + bungaBersihBulanan;
      totalBungaBersih += bungaBersihBulanan;

      html += `<tr>
                <td>${i}</td>
                <td>Rp ${Math.round(saldoAwalBulanIniTampil).toLocaleString("id-ID")}</td>
                <td>Rp ${Math.round(setoranBulanIni).toLocaleString("id-ID")}</td>
                <td>Rp ${Math.round(bungaKotorBulanan).toLocaleString("id-ID")}</td>
                <td>Rp ${Math.round(pajakBungaBulanan).toLocaleString("id-ID")}</td>
                <td>Rp ${Math.round(bungaBersihBulanan).toLocaleString("id-ID")}</td>
                <td>Rp ${Math.round(currentSaldo).toLocaleString("id-ID")}</td>
              </tr>`;
    }
    html += "</table>";
    html += "</div>";
    html += `<p><strong>Total Saldo Akhir Setelah ${tenorTabungan} Bulan: Rp ${Math.round(currentSaldo).toLocaleString("id-ID")}</strong></p>`;
    html += `<p><strong>Total Bunga Bersih Diterima: Rp ${Math.round(totalBungaBersih).toLocaleString("id-ID")}</strong></p>`;

    document.getElementById("cetakButton").style.display = "block";
  }
  hasilEl.innerHTML = infoCetak + html;

  
  resultContainer.style.opacity = "0";
  resultContainer.style.transform = "translateY(20px)";
  resultContainer.style.animation = "none";
  void resultContainer.offsetWidth;
  resultContainer.style.animation = "fadeInSlideUp 0.6s ease-out forwards";
}


const darkModeToggle = document.getElementById('darkModeToggle');
const body = document.body;

function setDarkMode(isDark) {
    if (isDark) {
        body.classList.add('dark-mode');
        darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
        localStorage.setItem('darkMode', 'enabled');
    } else {
        body.classList.remove('dark-mode');
        darkModeToggle.innerHTML = '<i class="fas fa-moon"></i>';
        localStorage.setItem('darkMode', 'disabled');
    }
}


document.addEventListener('DOMContentLoaded', () => {
    ubahForm(); 

    
    const savedMode = localStorage.getItem('darkMode');
    if (savedMode === 'enabled') {
        setDarkMode(true);
    } else {
        setDarkMode(false);
    }

    
    document.getElementById('currentYear').textContent = new Date().getFullYear();
});


darkModeToggle.addEventListener('click', () => {
    setDarkMode(!body.classList.contains('dark-mode'));
});

</script>
</body>
</html>